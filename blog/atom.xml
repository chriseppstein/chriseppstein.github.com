<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>#chris-eppstein {position: unique;}</title>
  <link href="http://chriseppstein.github.com/atom.xml" rel="self" />
  <link href="http://chriseppstein.github.com/" />
  <updated>2009-09-13T13:42:09-07:00</updated>
  <id>http://chriseppstein.github.com/</id>
  <author>
    <name>Chris Eppstein</name>
    <email>chris[at]eppsteins[dawt]net</email>
  </author>
  <entry>
    <title>Building a Jekyll Watcher with FSSM</title>
    <link href="http://chriseppstein.github.com/blog/2009/09/07/building-a-jekyll-watcher-with-fssm" />
    <updated>2009-09-07T00:00:00-07:00</updated>
    <id>http://chriseppstein.github.com/blog/2009/09/07/building-a-jekyll-watcher-with-fssm</id>
    <content type="html">
      &lt;p&gt;Travis Tilley&#8217;s &lt;a href=&quot;http://github.com/ttilley/fssm/tree/master&quot;&gt;File System State Monitor&lt;/a&gt; provides a fantastic API for monitoring a filesystem and&#x000A;performing actions when changes occur. It has multiple, platform-specific backends for dealing efficiently&#x000A;with filesystems and will resort to polling if it has to. I have already integrated it into &lt;a href=&quot;http://github.com/chriseppstein/compass/tree/master&quot;&gt;Compass&lt;/a&gt;&#x000A;to implement the &lt;code&gt;--watch&lt;/code&gt; functionality.&lt;/p&gt;&#x000A;&#x000A;&lt;p&gt;When building this blog, I used it to trivially build a watcher for changes to the blog contents and&#x000A;regenerate the site using &lt;a href=&quot;http://github.com/mojombo/jekyll/tree/master&quot;&gt;jekyll&lt;/a&gt; if anything changed. Coupled with &lt;a href=&quot;http://github.com/jlong/serve/tree/master&quot;&gt;serve&lt;/a&gt;, I can&#x000A;basically forget that I&#8217;m developing a static website that has to be compiled. I&#8217;ve documented the basic&#x000A;steps required to build your own watcher here.&lt;/p&gt;&#x000A;&#x000A;&lt;h3&gt;Install FSSM&lt;/h3&gt;&#x000A;&#x000A;&lt;pre class=&quot;console window&quot;&gt;&lt;span class=&quot;prompt&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;stdin&quot;&gt;sudo gem install ttilley-fssm&lt;/span&gt;&#x000A;&lt;span class=&quot;stdout&quot;&gt;Password:&#x000A;Successfully installed ttilley-fssm-0.0.6&#x000A;1 gem installed&#x000A;Installing ri documentation for ttilley-fssm-0.0.6...&#x000A;Installing RDoc documentation for ttilley-fssm-0.0.6...&lt;/span&gt;&#x000A;&lt;/pre&gt;&#x000A;&#x000A;&#x000A;&lt;h3&gt;Define An Update Function&lt;/h3&gt;&#x000A;&#x000A;&lt;p&gt;This update function uses pipes because I wanted to see the output as it was emitted.&lt;/p&gt;&#x000A;&#x000A;&lt;div class=&quot;editor window&quot;&gt;&#x000A;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rebuild_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&#x000A;  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&gt;&gt;&gt; Change Detected to: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;&lt;&lt;&quot;&lt;/span&gt;&#x000A;  &lt;span class=&quot;no&quot;&gt;IO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;popen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;rake generate&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&#x000A;    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readpartial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;until&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eof?&lt;/span&gt;&#x000A;  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&#x000A;  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;&gt;&gt;&gt; Update Complete &lt;&lt;&lt;&#39;&lt;/span&gt;&#x000A;&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&#x000A;&lt;/pre&gt;&#x000A;&lt;/div&gt;&#x000A;&#x000A;&#x000A;&lt;p&gt;&lt;/div&gt;&lt;/p&gt;&#x000A;&#x000A;&lt;h3&gt;Create a Watch Task&lt;/h3&gt;&#x000A;&#x000A;&lt;div class=&quot;editor window&quot;&gt;&#x000A;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Watch the site and regenerate when it changes&quot;&lt;/span&gt;&#x000A;&lt;span class=&quot;n&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:watch&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&#x000A;  &lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;fssm&#39;&lt;/span&gt;&#x000A;  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&gt;&gt;&gt; Watching for Changes &lt;&lt;&lt;&quot;&lt;/span&gt;&#x000A;  &lt;span class=&quot;no&quot;&gt;FSSM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;monitor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dirname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;__FILE__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/_source&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;**/*&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&#x000A;    &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rebuild_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;&#x000A;    &lt;span class=&quot;n&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rebuild_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;&#x000A;    &lt;span class=&quot;n&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rebuild_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;&#x000A;  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&#x000A;&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&#x000A;&lt;/pre&gt;&#x000A;&lt;/div&gt;&#x000A;&#x000A;&#x000A;&lt;p&gt;&lt;/div&gt;&lt;/p&gt;&#x000A;&#x000A;&lt;h3&gt;Invoke It&lt;/h3&gt;&#x000A;&#x000A;&lt;pre class=&quot;console window&quot;&gt;&lt;span class=&quot;prompt&quot;&gt;~/Projects/chriseppstein.github.com&lt;/span&gt; &lt;span class=&quot;stdin&quot;&gt;rake watch&lt;/span&gt;&#x000A;&lt;span class=&quot;stdout&quot;&gt;(in /Users/chris/Projects/chriseppstein.github.com)&#x000A;&gt;&gt;&gt; Watching for Changes &lt;&lt;&lt;&lt;/span&gt;&#x000A;&lt;/pre&gt;&#x000A;
    </content>
  </entry>
</feed>
